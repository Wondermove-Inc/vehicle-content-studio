import e from"./dom-utils/getCompositeRect.js";import t from"./dom-utils/getLayoutRect.js";import o from"./dom-utils/listScrollParents.js";import r from"./dom-utils/getOffsetParent.js";import n from"./utils/orderModifiers.js";import i from"./utils/debounce.js";import s from"./utils/mergeByName.js";import{isElement as f}from"./dom-utils/instanceOf.js";var a={placement:"bottom",modifiers:[],strategy:"absolute"};function c(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function p(p){void 0===p&&(p={});var d=p,u=d.defaultModifiers,m=void 0===u?[]:u,l=d.defaultOptions,v=void 0===l?a:l;return function(p,d,u){void 0===u&&(u=v);var l={placement:"bottom",orderedModifiers:[],options:Object.assign({},a,v),modifiersData:{},elements:{reference:p,popper:d},attributes:{},styles:{}},g=[],j=!1,y={state:l,setOptions:function(e){var t="function"==typeof e?e(l.options):e;b(),l.options=Object.assign({},v,l.options,t),l.scrollParents={reference:f(p)?o(p):p.contextElement?o(p.contextElement):[],popper:o(d)};var r=n(s([].concat(m,l.options.modifiers)));return l.orderedModifiers=r.filter((function(e){return e.enabled})),l.orderedModifiers.forEach((function(e){var t=e.name,o=e.options,r=void 0===o?{}:o,n=e.effect;if("function"==typeof n){var i=n({state:l,name:t,instance:y,options:r}),s=function(){};g.push(i||s)}})),y.update()},forceUpdate:function(){if(!j){var o=l.elements,n=o.reference,i=o.popper;if(c(n,i)){l.rects={reference:e(n,r(i),"fixed"===l.options.strategy),popper:t(i)},l.reset=!1,l.placement=l.options.placement,l.orderedModifiers.forEach((function(e){return l.modifiersData[e.name]=Object.assign({},e.data)}));for(var s=0;s<l.orderedModifiers.length;s++)if(!0!==l.reset){var f=l.orderedModifiers[s],a=f.fn,p=f.options,d=void 0===p?{}:p,u=f.name;"function"==typeof a&&(l=a({state:l,options:d,name:u,instance:y})||l)}else l.reset=!1,s=-1}}},update:i((function(){return new Promise((function(e){y.forceUpdate(),e(l)}))})),destroy:function(){b(),j=!0}};if(!c(p,d))return y;function b(){g.forEach((function(e){return e()})),g=[]}return y.setOptions(u).then((function(e){!j&&u.onFirstUpdate&&u.onFirstUpdate(e)})),y}}export{p as popperGenerator};
