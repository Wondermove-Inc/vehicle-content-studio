"use client";
import e from"../../../@babel/runtime/helpers/esm/extends.js";import o from"../../../@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js";import*as t from"react";import n from"../../../prop-types/index.js";import{clsx as r}from"../../../clsx/dist/clsx.js";import i from"../styles/styled.js";import s from"../styles/useThemeProps.js";import{getPopoverUtilityClass as l}from"./popoverClasses.js";import{jsx as a}from"react/jsx-runtime";import p from"../Modal/Modal.js";import c from"../Paper/Paper.js";import u from"../../utils/useForkRef/useForkRef.js";import m from"../../utils/ownerDocument/ownerDocument.js";import f from"../../utils/ownerWindow/ownerWindow.js";import h from"../../utils/debounce/debounce.js";import{useSlotProps as d}from"../../base/utils/useSlotProps.js";import{isHostComponent as v}from"../../base/utils/isHostComponent.js";import b from"../../utils/refType/refType.js";import y from"../../utils/chainPropTypes/chainPropTypes.js";import T from"../../utils/HTMLElementType/HTMLElementType.js";import g from"../../utils/integerPropType/integerPropType.js";import P from"../../utils/elementTypeAcceptingRef/elementTypeAcceptingRef.js";import E from"../../utils/composeClasses/composeClasses.js";import O from"../Grow/Grow.js";const j=["onEntering"],w=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],R=["slotProps"];function x(e,o){let t=0;return"number"==typeof o?t=o:"center"===o?t=e.height/2:"bottom"===o&&(t=e.height),t}function N(e,o){let t=0;return"number"==typeof o?t=o:"center"===o?t=e.width/2:"right"===o&&(t=e.width),t}function C(e){return[e.horizontal,e.vertical].map((e=>"number"==typeof e?`${e}px`:e)).join(" ")}function M(e){return"function"==typeof e?e():e}const z=i(p,{name:"MuiPopover",slot:"Root",overridesResolver:(e,o)=>o.root})({}),k=i(c,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,o)=>o.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),S=t.forwardRef((function(n,i){var p,c,b;const y=s({props:n,name:"MuiPopover"}),{action:T,anchorEl:g,anchorOrigin:P={vertical:"top",horizontal:"left"},anchorPosition:S,anchorReference:D="anchorEl",children:L,className:H,container:q,elevation:I=8,marginThreshold:V=16,open:W,PaperProps:_={},slots:U,slotProps:$,transformOrigin:A={vertical:"top",horizontal:"left"},TransitionComponent:B=O,transitionDuration:F="auto",TransitionProps:{onEntering:G}={},disableScrollLock:Y=!1}=y,X=o(y.TransitionProps,j),J=o(y,w),K=null!=(p=null==$?void 0:$.paper)?p:_,Q=t.useRef(),Z=u(Q,K.ref),ee=e({},y,{anchorOrigin:P,anchorReference:D,elevation:I,marginThreshold:V,externalPaperSlotProps:K,transformOrigin:A,TransitionComponent:B,transitionDuration:F,TransitionProps:X}),oe=(e=>{const{classes:o}=e;return E({root:["root"],paper:["paper"]},l,o)})(ee),te=t.useCallback((()=>{if("anchorPosition"===D)return"production"!==process.env.NODE_ENV&&(S||console.error('MUI: You need to provide a `anchorPosition` prop when using <Popover anchorReference="anchorPosition" />.')),S;const e=M(g),o=e&&1===e.nodeType?e:m(Q.current).body,t=o.getBoundingClientRect();if("production"!==process.env.NODE_ENV){const e=o.getBoundingClientRect();"test"!==process.env.NODE_ENV&&0===e.top&&0===e.left&&0===e.right&&0===e.bottom&&console.warn(["MUI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))}return{top:t.top+x(t,P.vertical),left:t.left+N(t,P.horizontal)}}),[g,P.horizontal,P.vertical,S,D]),ne=t.useCallback((e=>({vertical:x(e,A.vertical),horizontal:N(e,A.horizontal)})),[A.horizontal,A.vertical]),re=t.useCallback((e=>{const o={width:e.offsetWidth,height:e.offsetHeight},t=ne(o);if("none"===D)return{top:null,left:null,transformOrigin:C(t)};const n=te();let r=n.top-t.vertical,i=n.left-t.horizontal;const s=r+o.height,l=i+o.width,a=f(M(g)),p=a.innerHeight-V,c=a.innerWidth-V;if(null!==V&&r<V){const e=r-V;r-=e,t.vertical+=e}else if(null!==V&&s>p){const e=s-p;r-=e,t.vertical+=e}if("production"!==process.env.NODE_ENV&&o.height>p&&o.height&&p&&console.error(["MUI: The popover component is too tall.",`Some part of it can not be seen on the screen (${o.height-p}px).`,"Please consider adding a `max-height` to improve the user-experience."].join("\n")),null!==V&&i<V){const e=i-V;i-=e,t.horizontal+=e}else if(l>c){const e=l-c;i-=e,t.horizontal+=e}return{top:`${Math.round(r)}px`,left:`${Math.round(i)}px`,transformOrigin:C(t)}}),[g,D,te,ne,V]),[ie,se]=t.useState(W),le=t.useCallback((()=>{const e=Q.current;if(!e)return;const o=re(e);null!==o.top&&(e.style.top=o.top),null!==o.left&&(e.style.left=o.left),e.style.transformOrigin=o.transformOrigin,se(!0)}),[re]);t.useEffect((()=>(Y&&window.addEventListener("scroll",le),()=>window.removeEventListener("scroll",le))),[g,Y,le]);t.useEffect((()=>{W&&le()})),t.useImperativeHandle(T,(()=>W?{updatePosition:()=>{le()}}:null),[W,le]),t.useEffect((()=>{if(!W)return;const e=h((()=>{le()})),o=f(g);return o.addEventListener("resize",e),()=>{e.clear(),o.removeEventListener("resize",e)}}),[g,W,le]);let ae=F;"auto"!==F||B.muiSupportAuto||(ae=void 0);const pe=q||(g?m(M(g)).body:void 0),ce=null!=(c=null==U?void 0:U.root)?c:z,ue=null!=(b=null==U?void 0:U.paper)?b:k,me=d({elementType:ue,externalSlotProps:e({},K,{style:ie?K.style:e({},K.style,{opacity:0})}),additionalProps:{elevation:I,ref:Z},ownerState:ee,className:r(oe.paper,null==K?void 0:K.className)}),fe=d({elementType:ce,externalSlotProps:(null==$?void 0:$.root)||{},externalForwardedProps:J,additionalProps:{ref:i,slotProps:{backdrop:{invisible:!0}},container:pe,open:W},ownerState:ee,className:r(oe.root,H)}),{slotProps:he}=fe,de=o(fe,R);return a(ce,e({},de,!v(ce)&&{slotProps:he,disableScrollLock:Y},{children:a(B,e({appear:!0,in:W,onEntering:(e,o)=>{G&&G(e,o),le()},onExited:()=>{se(!1)},timeout:ae},X,{children:a(ue,e({},me,{children:L}))}))}))}));"production"!==process.env.NODE_ENV&&(S.propTypes={action:b,anchorEl:y(n.oneOfType([T,n.func]),(e=>{if(e.open&&(!e.anchorReference||"anchorEl"===e.anchorReference)){const o=M(e.anchorEl);if(!o||1!==o.nodeType)return new Error(["MUI: The `anchorEl` prop provided to the component is invalid.",`It should be an Element or PopoverVirtualElement instance but it's \`${o}\` instead.`].join("\n"));{const e=o.getBoundingClientRect();if("test"!==process.env.NODE_ENV&&0===e.top&&0===e.left&&0===e.right&&0===e.bottom)return new Error(["MUI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))}}return null})),anchorOrigin:n.shape({horizontal:n.oneOfType([n.oneOf(["center","left","right"]),n.number]).isRequired,vertical:n.oneOfType([n.oneOf(["bottom","center","top"]),n.number]).isRequired}),anchorPosition:n.shape({left:n.number.isRequired,top:n.number.isRequired}),anchorReference:n.oneOf(["anchorEl","anchorPosition","none"]),children:n.node,classes:n.object,className:n.string,container:n.oneOfType([T,n.func]),disableScrollLock:n.bool,elevation:g,marginThreshold:n.number,onClose:n.func,open:n.bool.isRequired,PaperProps:n.shape({component:P}),slotProps:n.shape({paper:n.oneOfType([n.func,n.object]),root:n.oneOfType([n.func,n.object])}),slots:n.shape({paper:n.elementType,root:n.elementType}),sx:n.oneOfType([n.arrayOf(n.oneOfType([n.func,n.object,n.bool])),n.func,n.object]),transformOrigin:n.shape({horizontal:n.oneOfType([n.oneOf(["center","left","right"]),n.number]).isRequired,vertical:n.oneOfType([n.oneOf(["bottom","center","top"]),n.number]).isRequired}),TransitionComponent:n.elementType,transitionDuration:n.oneOfType([n.oneOf(["auto"]),n.number,n.shape({appear:n.number,enter:n.number,exit:n.number})]),TransitionProps:n.object});var D=S;export{k as PopoverPaper,z as PopoverRoot,D as default,N as getOffsetLeft,x as getOffsetTop};
