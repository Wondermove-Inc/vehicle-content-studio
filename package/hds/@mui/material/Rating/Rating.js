"use client";
import e from"../../../@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js";import o from"../../../@babel/runtime/helpers/esm/extends.js";import*as n from"react";import i from"../../../prop-types/index.js";import{clsx as t}from"../../../clsx/dist/clsx.js";import{useRtl as s}from"../../system/esm/RtlProvider/index.js";import l from"../internal/svg-icons/Star.js";import r from"../internal/svg-icons/StarBorder.js";import a from"../styles/useThemeProps.js";import c from"../styles/styled.js";import u,{getRatingUtilityClass as d}from"./ratingClasses.js";import{jsxs as m,jsx as p}from"react/jsx-runtime";import v from"../../utils/capitalize/capitalize.js";import f from"../../utils/visuallyHidden/visuallyHidden.js";import y from"../styles/slotShouldForwardProp.js";import h from"../../utils/useId/useId.js";import b from"../../utils/useControlled/useControlled.js";import g from"../../utils/useIsFocusVisible/useIsFocusVisible.js";import R from"../../utils/useForkRef/useForkRef.js";import C from"../../utils/chainPropTypes/chainPropTypes.js";import F from"../../utils/composeClasses/composeClasses.js";import S from"../../utils/clamp/clamp.js";const V=["value"],x=["className","defaultValue","disabled","emptyIcon","emptyLabelText","getLabelText","highlightSelectedOnly","icon","IconContainerComponent","max","name","onChange","onChangeActive","onMouseLeave","onMouseMove","precision","readOnly","size","value"];function j(e,o){if(null==e)return e;const n=Math.round(e/o)*o;return Number(n.toFixed(function(e){const o=e.toString().split(".")[1];return o?o.length:0}(o)))}const A=c("span",{name:"MuiRating",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:n}=e;return[{[`& .${u.visuallyHidden}`]:o.visuallyHidden},o.root,o[`size${v(n.size)}`],n.readOnly&&o.readOnly]}})((({theme:e,ownerState:n})=>o({display:"inline-flex",position:"relative",fontSize:e.typography.pxToRem(24),color:"#faaf00",cursor:"pointer",textAlign:"left",width:"min-content",WebkitTapHighlightColor:"transparent",[`&.${u.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${u.focusVisible} .${u.iconActive}`]:{outline:"1px solid #999"},[`& .${u.visuallyHidden}`]:f},"small"===n.size&&{fontSize:e.typography.pxToRem(18)},"large"===n.size&&{fontSize:e.typography.pxToRem(30)},n.readOnly&&{pointerEvents:"none"}))),O=c("label",{name:"MuiRating",slot:"Label",overridesResolver:({ownerState:e},o)=>[o.label,e.emptyValueFocused&&o.labelEmptyValueActive]})((({ownerState:e})=>o({cursor:"inherit"},e.emptyValueFocused&&{top:0,bottom:0,position:"absolute",outline:"1px solid #999",width:"100%"}))),T=c("span",{name:"MuiRating",slot:"Icon",overridesResolver:(e,o)=>{const{ownerState:n}=e;return[o.icon,n.iconEmpty&&o.iconEmpty,n.iconFilled&&o.iconFilled,n.iconHover&&o.iconHover,n.iconFocus&&o.iconFocus,n.iconActive&&o.iconActive]}})((({theme:e,ownerState:n})=>o({display:"flex",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),pointerEvents:"none"},n.iconActive&&{transform:"scale(1.2)"},n.iconEmpty&&{color:(e.vars||e).palette.action.disabled}))),w=c("span",{name:"MuiRating",slot:"Decimal",shouldForwardProp:e=>y(e)&&"iconActive"!==e,overridesResolver:(e,o)=>{const{iconActive:n}=e;return[o.decimal,n&&o.iconActive]}})((({iconActive:e})=>o({position:"relative"},e&&{transform:"scale(1.2)"})));function E(n){const i=e(n,V);return p("span",o({},i))}function M(e){const{classes:i,disabled:s,emptyIcon:l,focus:r,getLabelText:a,highlightSelectedOnly:c,hover:u,icon:d,IconContainerComponent:v,isActive:f,itemValue:y,labelProps:b,name:g,onBlur:R,onChange:C,onClick:F,onFocus:S,readOnly:V,ownerState:x,ratingValue:j,ratingValueRounded:A}=e,w=c?y===j:y<=j,E=y<=u,M=y<=r,I=y===A,H=h(),N=p(T,{as:v,value:y,className:t(i.icon,w?i.iconFilled:i.iconEmpty,E&&i.iconHover,M&&i.iconFocus,f&&i.iconActive),ownerState:o({},x,{iconEmpty:!w,iconFilled:w,iconHover:E,iconFocus:M,iconActive:f}),children:l&&!w?l:d});return V?p("span",o({},b,{children:N})):m(n.Fragment,{children:[m(O,o({ownerState:o({},x,{emptyValueFocused:void 0}),htmlFor:H},b,{children:[N,p("span",{className:i.visuallyHidden,children:a(y)})]})),p("input",{className:i.visuallyHidden,onFocus:S,onBlur:R,onChange:C,onClick:F,disabled:s,value:y,id:H,type:"radio",name:g,checked:I})]})}"production"!==process.env.NODE_ENV&&(E.propTypes={value:i.number.isRequired}),"production"!==process.env.NODE_ENV&&(M.propTypes={classes:i.object.isRequired,disabled:i.bool.isRequired,emptyIcon:i.node,focus:i.number.isRequired,getLabelText:i.func.isRequired,highlightSelectedOnly:i.bool.isRequired,hover:i.number.isRequired,icon:i.node,IconContainerComponent:i.elementType.isRequired,isActive:i.bool.isRequired,itemValue:i.number.isRequired,labelProps:i.object,name:i.string,onBlur:i.func.isRequired,onChange:i.func.isRequired,onClick:i.func.isRequired,onFocus:i.func.isRequired,ownerState:i.object.isRequired,ratingValue:i.number,ratingValueRounded:i.number,readOnly:i.bool.isRequired});const I=p(l,{fontSize:"inherit"}),H=p(r,{fontSize:"inherit"});function N(e){return`${e} Star${1!==e?"s":""}`}const z=n.forwardRef((function(i,l){const r=a({name:"MuiRating",props:i}),{className:c,defaultValue:u=null,disabled:f=!1,emptyIcon:y=H,emptyLabelText:C="Empty",getLabelText:V=N,highlightSelectedOnly:T=!1,icon:z=I,IconContainerComponent:L=E,max:q=5,name:P,onChange:$,onChangeActive:k,onMouseLeave:B,onMouseMove:D,precision:X=1,readOnly:_=!1,size:W="medium",value:U}=r,Y=e(r,x),G=h(P),[J,K]=b({controlled:U,default:u,name:"Rating"}),Q=j(J,X),Z=s(),[{hover:ee,focus:oe},ne]=n.useState({hover:-1,focus:-1});let ie=Q;-1!==ee&&(ie=ee),-1!==oe&&(ie=oe);const{isFocusVisibleRef:te,onBlur:se,onFocus:le,ref:re}=g(),[ae,ce]=n.useState(!1),ue=n.useRef(),de=R(re,ue,l),me=e=>{let o=""===e.target.value?null:parseFloat(e.target.value);-1!==ee&&(o=ee),K(o),$&&$(e,o)},pe=e=>{0===e.clientX&&0===e.clientY||(ne({hover:-1,focus:-1}),K(null),$&&parseFloat(e.target.value)===Q&&$(e,null))},ve=e=>{le(e),!0===te.current&&ce(!0);const o=parseFloat(e.target.value);ne((e=>({hover:e.hover,focus:o})))},fe=e=>{if(-1!==ee)return;se(e),!1===te.current&&ce(!1);ne((e=>({hover:e.hover,focus:-1})))},[ye,he]=n.useState(!1),be=o({},r,{defaultValue:u,disabled:f,emptyIcon:y,emptyLabelText:C,emptyValueFocused:ye,focusVisible:ae,getLabelText:V,icon:z,IconContainerComponent:L,max:q,precision:X,readOnly:_,size:W}),ge=(e=>{const{classes:o,size:n,readOnly:i,disabled:t,emptyValueFocused:s,focusVisible:l}=e,r={root:["root",`size${v(n)}`,t&&"disabled",l&&"focusVisible",i&&"readOnly"],label:["label","pristine"],labelEmptyValue:[s&&"labelEmptyValueActive"],icon:["icon"],iconEmpty:["iconEmpty"],iconFilled:["iconFilled"],iconHover:["iconHover"],iconFocus:["iconFocus"],iconActive:["iconActive"],decimal:["decimal"],visuallyHidden:["visuallyHidden"]};return F(r,d,o)})(be);return m(A,o({ref:de,onMouseMove:e=>{D&&D(e);const o=ue.current,{right:n,left:i,width:t}=o.getBoundingClientRect();let s;s=Z?(n-e.clientX)/t:(e.clientX-i)/t;let l=j(q*s+X/2,X);l=S(l,X,q),ne((e=>e.hover===l&&e.focus===l?e:{hover:l,focus:l})),ce(!1),k&&ee!==l&&k(e,l)},onMouseLeave:e=>{B&&B(e);ne({hover:-1,focus:-1}),k&&-1!==ee&&k(e,-1)},className:t(ge.root,c,_&&"MuiRating-readOnly"),ownerState:be,role:_?"img":null,"aria-label":_?V(ie):null},Y,{children:[Array.from(new Array(q)).map(((e,n)=>{const i=n+1,s={classes:ge,disabled:f,emptyIcon:y,focus:oe,getLabelText:V,highlightSelectedOnly:T,hover:ee,icon:z,IconContainerComponent:L,name:G,onBlur:fe,onChange:me,onClick:pe,onFocus:ve,ratingValue:ie,ratingValueRounded:Q,readOnly:_,ownerState:be},l=i===Math.ceil(ie)&&(-1!==ee||-1!==oe);if(X<1){const e=Array.from(new Array(1/X));return p(w,{className:t(ge.decimal,l&&ge.iconActive),ownerState:be,iconActive:l,children:e.map(((n,t)=>{const l=j(i-1+(t+1)*X,X);return p(M,o({},s,{isActive:!1,itemValue:l,labelProps:{style:e.length-1===t?{}:{width:l===ie?(t+1)*X*100+"%":"0%",overflow:"hidden",position:"absolute"}}}),l)}))},i)}return p(M,o({},s,{isActive:l,itemValue:i}),i)})),!_&&!f&&m(O,{className:t(ge.label,ge.labelEmptyValue),ownerState:be,children:[p("input",{className:ge.visuallyHidden,value:"",id:`${G}-empty`,type:"radio",name:G,checked:null==Q,onFocus:()=>he(!0),onBlur:()=>he(!1),onChange:me}),p("span",{className:ge.visuallyHidden,children:C})]})]}))}));"production"!==process.env.NODE_ENV&&(z.propTypes={classes:i.object,className:i.string,defaultValue:i.number,disabled:i.bool,emptyIcon:i.node,emptyLabelText:i.node,getLabelText:i.func,highlightSelectedOnly:i.bool,icon:i.node,IconContainerComponent:i.elementType,max:i.number,name:i.string,onChange:i.func,onChangeActive:i.func,onMouseLeave:i.func,onMouseMove:i.func,precision:C(i.number,(e=>e.precision<.1?new Error(["MUI: The prop `precision` should be above 0.1.","A value below this limit has an imperceptible impact."].join("\n")):null)),readOnly:i.bool,size:i.oneOfType([i.oneOf(["small","medium","large"]),i.string]),sx:i.oneOfType([i.arrayOf(i.oneOfType([i.func,i.object,i.bool])),i.func,i.object]),value:i.number});var L=z;export{L as default};
