"use client";
import e from"../../../@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js";import o from"../../../@babel/runtime/helpers/esm/extends.js";import*as t from"react";import{r}from"../../../react-is/index.js";import l from"../../../prop-types/index.js";import{clsx as n}from"../../../clsx/dist/clsx.js";import{useRtl as s}from"../../system/esm/RtlProvider/index.js";import i from"../styles/styled.js";import a from"../styles/useThemeProps.js";import c from"../styles/useTheme.js";import d from"../internal/animate.js";import u from"./ScrollbarSize.js";import b,{getTabsUtilityClass as f}from"./tabsClasses.js";import{jsx as p,jsxs as m}from"react/jsx-runtime";import{useSlotProps as h}from"../../base/utils/useSlotProps.js";import v from"../../utils/useEventCallback/useEventCallback.js";import S from"../../utils/debounce/debounce.js";import w from"../../utils/ownerWindow/ownerWindow.js";import y from"../../utils/refType/refType.js";import B from"../../utils/composeClasses/composeClasses.js";import g from"../TabScrollButton/TabScrollButton.js";import C from"../../utils/ownerDocument/ownerDocument.js";import{getNormalizedScrollLeft as T,detectScrollType as x}from"../../utils/scrollLeft/scrollLeft.js";const E=["aria-label","aria-labelledby","action","centered","children","className","component","allowScrollButtonsMobile","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","slots","slotProps","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"],j=(e,o)=>e===o?e.firstChild:o&&o.nextElementSibling?o.nextElementSibling:e.firstChild,N=(e,o)=>e===o?e.lastChild:o&&o.previousElementSibling?o.previousElementSibling:e.lastChild,I=(e,o,t)=>{let r=!1,l=t(e,o);for(;l;){if(l===e.firstChild){if(r)return;r=!0}const o=l.disabled||"true"===l.getAttribute("aria-disabled");if(l.hasAttribute("tabindex")&&!o)return void l.focus();l=t(e,l)}},M=i("div",{name:"MuiTabs",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:t}=e;return[{[`& .${b.scrollButtons}`]:o.scrollButtons},{[`& .${b.scrollButtons}`]:t.scrollButtonsHideMobile&&o.scrollButtonsHideMobile},o.root,t.vertical&&o.vertical]}})((({ownerState:e,theme:t})=>o({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},e.vertical&&{flexDirection:"column"},e.scrollButtonsHideMobile&&{[`& .${b.scrollButtons}`]:{[t.breakpoints.down("sm")]:{display:"none"}}}))),O=i("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(e,o)=>{const{ownerState:t}=e;return[o.scroller,t.fixed&&o.fixed,t.hideScrollbar&&o.hideScrollbar,t.scrollableX&&o.scrollableX,t.scrollableY&&o.scrollableY]}})((({ownerState:e})=>o({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},e.fixed&&{overflowX:"hidden",width:"100%"},e.hideScrollbar&&{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},e.scrollableX&&{overflowX:"auto",overflowY:"hidden"},e.scrollableY&&{overflowY:"auto",overflowX:"hidden"}))),k=i("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:(e,o)=>{const{ownerState:t}=e;return[o.flexContainer,t.vertical&&o.flexContainerVertical,t.centered&&o.centered]}})((({ownerState:e})=>o({display:"flex"},e.vertical&&{flexDirection:"column"},e.centered&&{justifyContent:"center"}))),W=i("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:(e,o)=>o.indicator})((({ownerState:e,theme:t})=>o({position:"absolute",height:2,bottom:0,width:"100%",transition:t.transitions.create()},"primary"===e.indicatorColor&&{backgroundColor:(t.vars||t).palette.primary.main},"secondary"===e.indicatorColor&&{backgroundColor:(t.vars||t).palette.secondary.main},e.vertical&&{height:"100%",width:2,right:0}))),L=i(u)({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),P={};let D=!1;const R=t.forwardRef((function(l,i){const u=a({props:l,name:"MuiTabs"}),b=c(),y=s(),{"aria-label":R,"aria-labelledby":z,action:A,centered:X=!1,children:F,className:Y,component:H="div",allowScrollButtonsMobile:V=!1,indicatorColor:$="primary",onChange:_,orientation:U="horizontal",ScrollButtonComponent:K=g,scrollButtons:q="auto",selectionFollowsFocus:G,slots:J={},slotProps:Q={},TabIndicatorProps:Z={},TabScrollButtonProps:ee={},textColor:oe="primary",value:te,variant:re="standard",visibleScrollbar:le=!1}=u,ne=e(u,E),se="scrollable"===re,ie="vertical"===U,ae=ie?"scrollTop":"scrollLeft",ce=ie?"top":"left",de=ie?"bottom":"right",ue=ie?"clientHeight":"clientWidth",be=ie?"height":"width",fe=o({},u,{component:H,allowScrollButtonsMobile:V,indicatorColor:$,orientation:U,vertical:ie,scrollButtons:q,textColor:oe,variant:re,visibleScrollbar:le,fixed:!se,hideScrollbar:se&&!le,scrollableX:se&&!ie,scrollableY:se&&ie,centered:X&&!se,scrollButtonsHideMobile:!V}),pe=(e=>{const{vertical:o,fixed:t,hideScrollbar:r,scrollableX:l,scrollableY:n,centered:s,scrollButtonsHideMobile:i,classes:a}=e;return B({root:["root",o&&"vertical"],scroller:["scroller",t&&"fixed",r&&"hideScrollbar",l&&"scrollableX",n&&"scrollableY"],flexContainer:["flexContainer",o&&"flexContainerVertical",s&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",i&&"scrollButtonsHideMobile"],scrollableX:[l&&"scrollableX"],hideScrollbar:[r&&"hideScrollbar"]},f,a)})(fe),me=h({elementType:J.StartScrollButtonIcon,externalSlotProps:Q.startScrollButtonIcon,ownerState:fe}),he=h({elementType:J.EndScrollButtonIcon,externalSlotProps:Q.endScrollButtonIcon,ownerState:fe});"production"!==process.env.NODE_ENV&&X&&se&&console.error('MUI: You can not use the `centered={true}` and `variant="scrollable"` properties at the same time on a `Tabs` component.');const[ve,Se]=t.useState(!1),[we,ye]=t.useState(P),[Be,ge]=t.useState(!1),[Ce,Te]=t.useState(!1),[xe,Ee]=t.useState(!1),[je,Ne]=t.useState({overflow:"hidden",scrollbarWidth:0}),Ie=new Map,Me=t.useRef(null),Oe=t.useRef(null),ke=()=>{const e=Me.current;let o,t;if(e){const t=e.getBoundingClientRect();o={clientWidth:e.clientWidth,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,scrollLeftNormalized:T(e,y?"rtl":"ltr"),scrollWidth:e.scrollWidth,top:t.top,bottom:t.bottom,left:t.left,right:t.right}}if(e&&!1!==te){const e=Oe.current.children;if(e.length>0){const r=e[Ie.get(te)];"production"!==process.env.NODE_ENV&&(r||console.error(["MUI: The `value` provided to the Tabs component is invalid.",`None of the Tabs' children match with "${te}".`,Ie.keys?`You can provide one of the following values: ${Array.from(Ie.keys()).join(", ")}.`:null].join("\n"))),t=r?r.getBoundingClientRect():null,"production"!==process.env.NODE_ENV&&"test"!==process.env.NODE_ENV&&!D&&t&&0===t.width&&0===t.height&&0!==o.clientWidth&&(o=null,console.error(["MUI: The `value` provided to the Tabs component is invalid.",`The Tab with this \`value\` ("${te}") is not part of the document layout.`,"Make sure the tab item is present in the document or that it's not `display: none`."].join("\n")),D=!0)}}return{tabsMeta:o,tabMeta:t}},We=v((()=>{const{tabsMeta:e,tabMeta:o}=ke();let t,r=0;if(ie)t="top",o&&e&&(r=o.top-e.top+e.scrollTop);else if(t=y?"right":"left",o&&e){const l=y?e.scrollLeftNormalized+e.clientWidth-e.scrollWidth:e.scrollLeft;r=(y?-1:1)*(o[t]-e[t]+l)}const l={[t]:r,[be]:o?o[be]:0};if(isNaN(we[t])||isNaN(we[be]))ye(l);else{const e=Math.abs(we[t]-l[t]),o=Math.abs(we[be]-l[be]);(e>=1||o>=1)&&ye(l)}})),Le=(e,{animation:o=!0}={})=>{o?d(ae,Me.current,e,{duration:b.transitions.duration.standard}):Me.current[ae]=e},Pe=e=>{let o=Me.current[ae];ie?o+=e:(o+=e*(y?-1:1),o*=y&&"reverse"===x()?-1:1),Le(o)},De=()=>{const e=Me.current[ue];let o=0;const t=Array.from(Oe.current.children);for(let r=0;r<t.length;r+=1){const l=t[r];if(o+l[ue]>e){0===r&&(o=e);break}o+=l[ue]}return o},Re=()=>{Pe(-1*De())},ze=()=>{Pe(De())},Ae=t.useCallback((e=>{Ne({overflow:null,scrollbarWidth:e})}),[]),Xe=v((e=>{const{tabsMeta:o,tabMeta:t}=ke();if(t&&o)if(t[ce]<o[ce]){const r=o[ae]+(t[ce]-o[ce]);Le(r,{animation:e})}else if(t[de]>o[de]){const r=o[ae]+(t[de]-o[de]);Le(r,{animation:e})}})),Fe=v((()=>{se&&!1!==q&&Ee(!xe)}));t.useEffect((()=>{const e=S((()=>{Me.current&&We()}));let o;const t=t=>{t.forEach((e=>{e.removedNodes.forEach((e=>{var t;null==(t=o)||t.unobserve(e)})),e.addedNodes.forEach((e=>{var t;null==(t=o)||t.observe(e)}))})),e(),Fe()},r=w(Me.current);let l;return r.addEventListener("resize",e),"undefined"!=typeof ResizeObserver&&(o=new ResizeObserver(e),Array.from(Oe.current.children).forEach((e=>{o.observe(e)}))),"undefined"!=typeof MutationObserver&&(l=new MutationObserver(t),l.observe(Oe.current,{childList:!0})),()=>{var t,n;e.clear(),r.removeEventListener("resize",e),null==(t=l)||t.disconnect(),null==(n=o)||n.disconnect()}}),[We,Fe]),t.useEffect((()=>{const e=Array.from(Oe.current.children),o=e.length;if("undefined"!=typeof IntersectionObserver&&o>0&&se&&!1!==q){const t=e[0],r=e[o-1],l={root:Me.current,threshold:.99},n=new IntersectionObserver((e=>{ge(!e[0].isIntersecting)}),l);n.observe(t);const s=new IntersectionObserver((e=>{Te(!e[0].isIntersecting)}),l);return s.observe(r),()=>{n.disconnect(),s.disconnect()}}}),[se,q,xe,null==F?void 0:F.length]),t.useEffect((()=>{Se(!0)}),[]),t.useEffect((()=>{We()})),t.useEffect((()=>{Xe(P!==we)}),[Xe,we]),t.useImperativeHandle(A,(()=>({updateIndicator:We,updateScrollButtons:Fe})),[We,Fe]);const Ye=p(W,o({},Z,{className:n(pe.indicator,Z.className),ownerState:fe,style:o({},we,Z.style)}));let He=0;const Ve=t.Children.map(F,(e=>{if(!t.isValidElement(e))return null;"production"!==process.env.NODE_ENV&&r.isFragment(e)&&console.error(["MUI: The Tabs component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n"));const l=void 0===e.props.value?He:e.props.value;Ie.set(l,He);const n=l===te;return He+=1,t.cloneElement(e,o({fullWidth:"fullWidth"===re,indicator:n&&!ve&&Ye,selected:n,selectionFollowsFocus:G,onChange:_,textColor:oe,value:l},1!==He||!1!==te||e.props.tabIndex?{}:{tabIndex:0}))})),$e=(()=>{const e={};e.scrollbarSizeListener=se?p(L,{onChange:Ae,className:n(pe.scrollableX,pe.hideScrollbar)}):null;const t=se&&("auto"===q&&(Be||Ce)||!0===q);return e.scrollButtonStart=t?p(K,o({slots:{StartScrollButtonIcon:J.StartScrollButtonIcon},slotProps:{startScrollButtonIcon:me},orientation:U,direction:y?"right":"left",onClick:Re,disabled:!Be},ee,{className:n(pe.scrollButtons,ee.className)})):null,e.scrollButtonEnd=t?p(K,o({slots:{EndScrollButtonIcon:J.EndScrollButtonIcon},slotProps:{endScrollButtonIcon:he},orientation:U,direction:y?"left":"right",onClick:ze,disabled:!Ce},ee,{className:n(pe.scrollButtons,ee.className)})):null,e})();return m(M,o({className:n(pe.root,Y),ownerState:fe,ref:i,as:H},ne,{children:[$e.scrollButtonStart,$e.scrollbarSizeListener,m(O,{className:pe.scroller,ownerState:fe,style:{overflow:je.overflow,[ie?"margin"+(y?"Left":"Right"):"marginBottom"]:le?void 0:-je.scrollbarWidth},ref:Me,children:[p(k,{"aria-label":R,"aria-labelledby":z,"aria-orientation":"vertical"===U?"vertical":null,className:pe.flexContainer,ownerState:fe,onKeyDown:e=>{const o=Oe.current,t=C(o).activeElement;if("tab"!==t.getAttribute("role"))return;let r="horizontal"===U?"ArrowLeft":"ArrowUp",l="horizontal"===U?"ArrowRight":"ArrowDown";switch("horizontal"===U&&y&&(r="ArrowRight",l="ArrowLeft"),e.key){case r:e.preventDefault(),I(o,t,N);break;case l:e.preventDefault(),I(o,t,j);break;case"Home":e.preventDefault(),I(o,null,j);break;case"End":e.preventDefault(),I(o,null,N)}},ref:Oe,role:"tablist",children:Ve}),ve&&Ye]}),$e.scrollButtonEnd]}))}));"production"!==process.env.NODE_ENV&&(R.propTypes={action:y,allowScrollButtonsMobile:l.bool,"aria-label":l.string,"aria-labelledby":l.string,centered:l.bool,children:l.node,classes:l.object,className:l.string,component:l.elementType,indicatorColor:l.oneOfType([l.oneOf(["primary","secondary"]),l.string]),onChange:l.func,orientation:l.oneOf(["horizontal","vertical"]),ScrollButtonComponent:l.elementType,scrollButtons:l.oneOf(["auto",!1,!0]),selectionFollowsFocus:l.bool,slotProps:l.shape({endScrollButtonIcon:l.oneOfType([l.func,l.object]),startScrollButtonIcon:l.oneOfType([l.func,l.object])}),slots:l.shape({EndScrollButtonIcon:l.elementType,StartScrollButtonIcon:l.elementType}),sx:l.oneOfType([l.arrayOf(l.oneOfType([l.func,l.object,l.bool])),l.func,l.object]),TabIndicatorProps:l.object,TabScrollButtonProps:l.object,textColor:l.oneOf(["inherit","primary","secondary"]),value:l.any,variant:l.oneOf(["fullWidth","scrollable","standard"]),visibleScrollbar:l.bool});var z=R;export{z as default};
