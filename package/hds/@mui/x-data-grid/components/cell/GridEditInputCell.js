import e from"../../../../@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js";import o from"../../../../@babel/runtime/helpers/esm/extends.js";import*as s from"react";import t from"../../../../prop-types/index.js";import{getDataGridUtilityClass as r}from"../../constants/gridClasses.js";import{useGridRootProps as i}from"../../hooks/utils/useGridRootProps.js";import{useGridApiContext as a}from"../../hooks/utils/useGridApiContext.js";import{jsx as n}from"react/jsx-runtime";import l from"../../../material/styles/styled.js";import u from"../../../material/InputBase/InputBase.js";import d from"../../../utils/useEnhancedEffect/useEnhancedEffect.js";import c from"../../../utils/composeClasses/composeClasses.js";const p=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","hasFocus","isValidating","debounceMs","isProcessingProps","onValueChange"],m=l(u,{name:"MuiDataGrid",slot:"EditInputCell",overridesResolver:(e,o)=>o.editInputCell})((({theme:e})=>o({},e.typography.body2,{padding:"1px 0","& input":{padding:"0 16px",height:"100%"}}))),f=s.forwardRef(((t,l)=>{const u=i(),{id:f,value:b,field:g,colDef:h,hasFocus:C,debounceMs:R=200,isProcessingProps:j,onValueChange:y}=t,E=e(t,p),v=a(),V=s.useRef(),[P,x]=s.useState(b),q=(e=>{const{classes:o}=e;return c({root:["editInputCell"]},r,o)})(u),w=s.useCallback((async e=>{const o=e.target.value;y&&await y(e,o);const s=v.current.getColumn(g);let t=o;s.valueParser&&(t=s.valueParser(o,v.current.getRow(f),s,v)),x(t),v.current.setEditCellValue({id:f,field:g,value:t,debounceMs:R,unstable_skipValueParser:!0},e)}),[v,R,g,f,y]),I=v.current.unstable_getEditCellMeta(f,g);return s.useEffect((()=>{"debouncedSetEditCellValue"!==I?.changeReason&&x(b)}),[I,b]),d((()=>{C&&V.current.focus()}),[C]),n(m,o({ref:l,inputRef:V,className:q.root,ownerState:u,fullWidth:!0,type:"number"===h.type?h.type:"text",value:P??"",onChange:w,endAdornment:j?n(u.slots.loadIcon,{fontSize:"small",color:"action"}):void 0},E))}));"production"!==process.env.NODE_ENV&&(f.propTypes={api:t.object.isRequired,cellMode:t.oneOf(["edit","view"]).isRequired,changeReason:t.oneOf(["debouncedSetEditCellValue","setEditCellValue"]),colDef:t.object.isRequired,debounceMs:t.number,field:t.string.isRequired,formattedValue:t.any,hasFocus:t.bool.isRequired,id:t.oneOfType([t.number,t.string]).isRequired,isEditable:t.bool,isProcessingProps:t.bool,isValidating:t.bool,onValueChange:t.func,row:t.any.isRequired,rowNode:t.object.isRequired,tabIndex:t.oneOf([-1,0]).isRequired,value:t.any});const b=e=>n(f,o({},e));export{f as GridEditInputCell,b as renderEditInputCell};
