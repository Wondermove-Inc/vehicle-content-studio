import*as r from"react";import{useGridPrivateApiContext as e}from"../../hooks/utils/useGridPrivateApiContext.js";import{useGridRootProps as t}from"../../hooks/utils/useGridRootProps.js";import{getDataGridUtilityClass as o}from"../../constants/gridClasses.js";import{jsx as i}from"react/jsx-runtime";import s from"../../../system/esm/styled.js";import{useGridSelector as n}from"../../hooks/utils/useGridSelector.js";import l from"../../../utils/useEventCallback/useEventCallback.js";import a from"../../../utils/useOnMount/useOnMount.js";import c from"../../../utils/useForkRef/useForkRef.js";import u from"../../../utils/composeClasses/composeClasses.js";import{gridDimensionsSelector as p}from"../../hooks/features/dimensions/gridDimensionsSelectors.js";const v=s("div")({position:"absolute",display:"inline-block",zIndex:6,"& > div":{display:"inline-block"},"--size":"calc(max(var(--DataGrid-scrollbarSize), 14px))"}),d=s(v)({width:"var(--size)",height:"calc(var(--DataGrid-hasScrollY) * (100% - var(--DataGrid-topContainerHeight) - var(--DataGrid-bottomContainerHeight) - var(--DataGrid-hasScrollX) * var(--DataGrid-scrollbarSize)))",overflowY:"auto",overflowX:"hidden",outline:0,"& > div":{width:"var(--size)"},top:"var(--DataGrid-topContainerHeight)",right:"0px"}),m=s(v)({width:"100%",height:"var(--size)",overflowY:"hidden",overflowX:"auto",outline:0,"& > div":{height:"var(--size)"},bottom:"0px"}),f=s("div")({display:"inline-block"}),h=r.forwardRef((function(s,v){const h=e(),S=t(),b=r.useRef(!1),w=r.useRef(0),z=r.useRef(null),g=r.useRef(null),j=((r,e)=>{const{classes:t}=r;return u({root:["scrollbar",`scrollbar--${e}`],content:["scrollbarContent"]},o,t)})(S,s.position),k=n(h,p),R="vertical"===s.position?"height":"width",x="vertical"===s.position?"scrollTop":"scrollLeft",C="vertical"===s.position?k.hasScrollX:k.hasScrollY,G=k.minimumSize[R]+(C?k.scrollbarSize:0),D=("vertical"===s.position?k.viewportInnerSize.height:k.viewportOuterSize.width)*(G/k.viewportOuterSize[R]),y=l((()=>{const r=h.current.virtualScrollerRef.current,e=z.current;if(r[x]===w.current)return;if(b.current)return void(b.current=!1);b.current=!0;const t=r[x]/G;e[x]=t*D,w.current=r[x]})),E=l((()=>{const r=h.current.virtualScrollerRef.current,e=z.current;if(b.current)return void(b.current=!1);b.current=!0;const t=e[x]/D;r[x]=t*G}));a((()=>{const r=h.current.virtualScrollerRef.current,e=z.current;return r.addEventListener("scroll",y,{capture:!0}),e.addEventListener("scroll",E,{capture:!0}),()=>{r.removeEventListener("scroll",y,{capture:!0}),e.removeEventListener("scroll",E,{capture:!0})}})),r.useEffect((()=>{g.current.style.setProperty(R,`${D}px`)}),[D,R]);const L="vertical"===s.position?d:m;return i(L,{ref:c(v,z),className:j.root,tabIndex:-1,children:i(f,{ref:g,className:j.content})})}));export{h as GridVirtualScrollbar};
