import r from"../../../../../@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js";import e from"../../../../../@babel/runtime/helpers/esm/toPropertyKey.js";import*as s from"react";import{useGridApiMethod as o}from"../../utils/useGridApiMethod.js";const t=t=>{const c=s.useRef({}),p=s.useRef(!1),u=s.useCallback((r=>{!p.current&&r&&(p.current=!0,Object.values(r.appliers).forEach((r=>{r()})),p.current=!1)}),[]),a=s.useCallback(((r,e,s)=>{c.current[r]||(c.current[r]={processors:new Map,processorsAsArray:[],appliers:{}});const o=c.current[r];return o.processors.get(e)!==s&&(o.processors.set(e,s),o.processorsAsArray=Array.from(c.current[r].processors.values()),u(o)),()=>{c.current[r].processors.delete(e),c.current[r].processorsAsArray=Array.from(c.current[r].processors.values())}}),[u]),n=s.useCallback(((s,o,t)=>(c.current[s]||(c.current[s]={processors:new Map,processorsAsArray:[],appliers:{}}),c.current[s].appliers[o]=t,()=>{const t=c.current[s].appliers,p=r(t,[o].map(e));c.current[s].appliers=p})),[]),l=s.useCallback((r=>{u(c.current[r])}),[u]),i={unstable_applyPipeProcessors:s.useCallback(((...r)=>{const[e,s,o]=r;if(!c.current[e])return s;const t=c.current[e].processorsAsArray;let p=s;for(let r=0;r<t.length;r+=1)p=t[r](p,o);return p}),[])};o(t,{registerPipeProcessor:a,registerPipeApplier:n,requestPipeProcessorsApplication:l},"private"),o(t,i,"public")};export{t as useGridPipeProcessing};
