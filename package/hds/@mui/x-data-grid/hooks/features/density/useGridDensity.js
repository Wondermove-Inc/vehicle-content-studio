import t from"../../../../../@babel/runtime/helpers/esm/extends.js";import*as e from"react";import{useGridLogger as s}from"../../utils/useGridLogger.js";import{useGridApiMethod as r}from"../../utils/useGridApiMethod.js";import{gridDensitySelector as n}from"./densitySelector.js";import i from"../../../../utils/useEventCallback/useEventCallback.js";import{useGridRegisterPipeProcessor as o}from"../../core/pipeProcessing/useGridRegisterPipeProcessor.js";const a=(e,s)=>t({},e,{density:s.initialState?.density??s.density??"standard"}),d=(a,d)=>{const l=s(a,"useDensity");a.current.registerControlState({stateId:"density",propModel:d.density,propOnChange:d.onDensityChange,stateSelector:n,changeEvent:"densityChange"});const c=i((e=>{n(a.current.state)!==e&&(l.debug(`Set grid density to ${e}`),a.current.setState((s=>t({},s,{density:e}))))}));r(a,{setDensity:c},"public");const u=e.useCallback(((e,s)=>{const r=n(a.current.state);return!s.exportOnlyDirtyModels||null!=d.density||null!=d.initialState?.density?t({},e,{density:r}):e}),[a,d.density,d.initialState?.density]),y=e.useCallback(((e,s)=>{const r=s.stateToRestore?.density?s.stateToRestore.density:n(a.current.state);return a.current.setState((e=>t({},e,{density:r}))),e}),[a]);o(a,"exportState",u),o(a,"restoreState",y),e.useEffect((()=>{d.density&&a.current.setDensity(d.density)}),[a,d.density])};export{a as densityStateInitializer,d as useGridDensity};
