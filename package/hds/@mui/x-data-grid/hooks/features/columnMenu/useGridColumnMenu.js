import e from"../../../../../@babel/runtime/helpers/esm/extends.js";import*as n from"react";import{gridColumnMenuSelector as o}from"./columnMenuSelector.js";import{gridColumnLookupSelector as u,gridColumnVisibilityModelSelector as r,gridColumnFieldsSelector as t}from"../columns/gridColumnsSelector.js";import{useGridLogger as l}from"../../utils/useGridLogger.js";import{useGridApiMethod as i}from"../../utils/useGridApiMethod.js";import{useGridApiEventHandler as c}from"../../utils/useGridApiEventHandler.js";const s=n=>e({},n,{columnMenu:{open:!1}}),m=s=>{const m=l(s,"useGridColumnMenu"),d=n.useCallback((n=>{const u=o(s.current.state),r=n;(!0!==u.open||r!==u.field)&&(s.current.setState((o=>o.columnMenu.open&&o.columnMenu.field===n?o:(m.debug("Opening Column Menu"),e({},o,{columnMenu:{open:!0,field:n}})))),s.current.hidePreferences(),s.current.forceUpdate())}),[s,m]),f=n.useCallback((()=>{const n=o(s.current.state);if(n.field){const e=u(s),o=r(s),l=t(s);let i=n.field;if(e[i]||(i=l[0]),!1===o[i]){const e=l.filter((e=>e===i||!1!==o[e])),n=e.indexOf(i);i=e[n+1]||e[n-1]}s.current.setColumnHeaderFocus(i)}const l={open:!1,field:void 0};(l.open!==n.open||l.field!==n.field)&&(s.current.setState((n=>(m.debug("Hiding Column Menu"),e({},n,{columnMenu:l})))),s.current.forceUpdate())}),[s,m]),p=n.useCallback((e=>{m.debug("Toggle Column Menu");const n=o(s.current.state);n.open&&n.field===e?f():d(e)}),[s,m,d,f]);i(s,{showColumnMenu:d,hideColumnMenu:f,toggleColumnMenu:p},"public"),c(s,"columnResizeStart",f),c(s,"virtualScrollerWheel",s.current.hideColumnMenu),c(s,"virtualScrollerTouchMove",s.current.hideColumnMenu)};export{s as columnMenuStateInitializer,m as useGridColumnMenu};
