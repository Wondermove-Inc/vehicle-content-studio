import e from"../../../@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js";import a from"../../../@babel/runtime/helpers/esm/extends.js";import*as o from"react";import n from"../../../prop-types/index.js";import{clsx as s}from"../node_modules/clsx/dist/clsx.js";import{useCalendarState as t}from"./useCalendarState.js";import{useUtils as i,useDefaultDates as r}from"../internals/hooks/useUtils.js";import{PickersFadeTransitionGroup as l}from"./PickersFadeTransitionGroup.js";import{DayCalendar as d}from"./DayCalendar.js";import{useViews as u}from"../internals/hooks/useViews.js";import{findClosestEnabledDate as m,mergeDateAndTime as c,applyDefaultDate as h}from"../internals/utils/date-utils.js";import{useDefaultReduceAnimations as f}from"../internals/hooks/useDefaultReduceAnimations.js";import{getDateCalendarUtilityClass as b}from"./dateCalendarClasses.js";import{useControlledValueWithTimezone as D}from"../internals/hooks/useValueWithTimezone.js";import{singleItemValueManager as p}from"../internals/utils/valueManagers.js";import{VIEW_HEIGHT as g}from"../internals/constants/dimensions.js";import{jsxs as w,jsx as C}from"react/jsx-runtime";import y from"../../material/styles/styled.js";import{PickerViewRoot as j}from"../internals/components/PickerViewRoot/PickerViewRoot.js";import v from"../../utils/useId/useId.js";import{PickersCalendarHeader as V}from"../PickersCalendarHeader/PickersCalendarHeader.js";import{useSlotProps as P}from"../../base/utils/useSlotProps.js";import F from"../../utils/useEventCallback/useEventCallback.js";import{YearCalendar as M}from"../YearCalendar/YearCalendar.js";import{MonthCalendar as x}from"../MonthCalendar/MonthCalendar.js";import O from"../../utils/composeClasses/composeClasses.js";import T from"../../material/styles/useThemeProps.js";const k=["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsPerRow","monthsPerRow","timezone"];const N=y(j,{name:"MuiDateCalendar",slot:"Root",overridesResolver:(e,a)=>a.root})({display:"flex",flexDirection:"column",height:g}),R=y(l,{name:"MuiDateCalendar",slot:"ViewTransitionContainer",overridesResolver:(e,a)=>a.viewTransitionContainer})({}),A=o.forwardRef((function(n,l){const g=i(),y=v(),j=function(e,o){const n=i(),s=r(),t=f(),l=T({props:e,name:o});return a({},l,{loading:l.loading??!1,disablePast:l.disablePast??!1,disableFuture:l.disableFuture??!1,openTo:l.openTo??"day",views:l.views??["year","day"],reduceAnimations:l.reduceAnimations??t,renderLoading:l.renderLoading??(()=>C("span",{children:"..."})),minDate:h(n,l.minDate,s.minDate),maxDate:h(n,l.maxDate,s.maxDate)})}(n,"MuiDateCalendar"),{autoFocus:A,onViewChange:W,value:Y,defaultValue:z,referenceDate:S,disableFuture:E,disablePast:H,onChange:L,onYearChange:I,onMonthChange:B,reduceAnimations:G,shouldDisableDate:_,shouldDisableMonth:q,shouldDisableYear:K,view:U,views:$,openTo:J,className:Q,disabled:X,readOnly:Z,minDate:ee,maxDate:ae,disableHighlightToday:oe,focusedView:ne,onFocusedViewChange:se,showDaysOutsideCurrentMonth:te,fixedWeekNumber:ie,dayOfWeekFormatter:re,slots:le,slotProps:de,loading:ue,renderLoading:me,displayWeekNumber:ce,yearsPerRow:he,monthsPerRow:fe,timezone:be}=j,De=e(j,k),{value:pe,handleValueChange:ge,timezone:we}=D({name:"DateCalendar",timezone:be,value:Y,defaultValue:z,onChange:L,valueManager:p}),{view:Ce,setView:ye,focusedView:je,setFocusedView:ve,goToNextView:Ve,setValueAndGoToNextView:Pe}=u({view:U,views:$,openTo:J,onChange:ge,onViewChange:W,autoFocus:A,focusedView:ne,onFocusedViewChange:se}),{referenceDate:Fe,calendarState:Me,changeFocusedDay:xe,changeMonth:Oe,handleChangeMonth:Te,isDateDisabled:ke,onMonthSwitchingAnimationEnd:Ne}=t({value:pe,referenceDate:S,reduceAnimations:G,onMonthChange:B,minDate:ee,maxDate:ae,shouldDisableDate:_,disablePast:H,disableFuture:E,timezone:we}),Re=X&&pe||ee,Ae=X&&pe||ae,We=`${y}-grid-label`,Ye=null!==je,ze=le?.calendarHeader??V,Se=P({elementType:ze,externalSlotProps:de?.calendarHeader,additionalProps:{views:$,view:Ce,currentMonth:Me.currentMonth,onViewChange:ye,onMonthChange:(e,a)=>Te({newMonth:e,direction:a}),minDate:Re,maxDate:Ae,disabled:X,disablePast:H,disableFuture:E,reduceAnimations:G,timezone:we,labelId:We},ownerState:j}),Ee=F((e=>{const a=g.startOfMonth(e),o=g.endOfMonth(e),n=ke(e)?m({utils:g,date:e,minDate:g.isBefore(ee,a)?a:ee,maxDate:g.isAfter(ae,o)?o:ae,disablePast:H,disableFuture:E,isDateDisabled:ke,timezone:we}):e;n?(Pe(n,"finish"),B?.(a)):(Ve(),Oe(a)),xe(n,!0)})),He=F((e=>{const a=g.startOfYear(e),o=g.endOfYear(e),n=ke(e)?m({utils:g,date:e,minDate:g.isBefore(ee,a)?a:ee,maxDate:g.isAfter(ae,o)?o:ae,disablePast:H,disableFuture:E,isDateDisabled:ke,timezone:we}):e;n?(Pe(n,"finish"),I?.(n)):(Ve(),Oe(a)),xe(n,!0)})),Le=F((e=>ge(e?c(g,e,pe??Fe):e,"finish",Ce)));o.useEffect((()=>{null!=pe&&g.isValid(pe)&&Oe(pe)}),[pe]);const Ie=j,Be=(e=>{const{classes:a}=e;return O({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},b,a)})(Ie),Ge={disablePast:H,disableFuture:E,maxDate:ae,minDate:ee},_e={disableHighlightToday:oe,readOnly:Z,disabled:X,timezone:we,gridLabelId:We,slots:le,slotProps:de},qe=o.useRef(Ce);o.useEffect((()=>{qe.current!==Ce&&(je===qe.current&&ve(Ce,!0),qe.current=Ce)}),[je,ve,Ce]);const Ke=o.useMemo((()=>[pe]),[pe]);return w(N,a({ref:l,className:s(Be.root,Q),ownerState:Ie},De,{children:[C(ze,a({},Se,{slots:le,slotProps:de})),C(R,{reduceAnimations:G,className:Be.viewTransitionContainer,transKey:Ce,ownerState:Ie,children:w("div",{children:["year"===Ce&&C(M,a({},Ge,_e,{value:pe,onChange:He,shouldDisableYear:K,hasFocus:Ye,onFocusedViewChange:e=>ve("year",e),yearsPerRow:he,referenceDate:Fe})),"month"===Ce&&C(x,a({},Ge,_e,{hasFocus:Ye,className:Q,value:pe,onChange:Ee,shouldDisableMonth:q,onFocusedViewChange:e=>ve("month",e),monthsPerRow:fe,referenceDate:Fe})),"day"===Ce&&C(d,a({},Me,Ge,_e,{onMonthSwitchingAnimationEnd:Ne,onFocusedDayChange:xe,reduceAnimations:G,selectedDays:Ke,onSelectedDaysChange:Le,shouldDisableDate:_,shouldDisableMonth:q,shouldDisableYear:K,hasFocus:Ye,onFocusedViewChange:e=>ve("day",e),showDaysOutsideCurrentMonth:te,fixedWeekNumber:ie,dayOfWeekFormatter:re,displayWeekNumber:ce,loading:ue,renderLoading:me}))]})})]}))}));"production"!==process.env.NODE_ENV&&(A.propTypes={autoFocus:n.bool,classes:n.object,className:n.string,dayOfWeekFormatter:n.func,defaultValue:n.object,disabled:n.bool,disableFuture:n.bool,disableHighlightToday:n.bool,disablePast:n.bool,displayWeekNumber:n.bool,fixedWeekNumber:n.number,focusedView:n.oneOf(["day","month","year"]),loading:n.bool,maxDate:n.object,minDate:n.object,monthsPerRow:n.oneOf([3,4]),onChange:n.func,onFocusedViewChange:n.func,onMonthChange:n.func,onViewChange:n.func,onYearChange:n.func,openTo:n.oneOf(["day","month","year"]),readOnly:n.bool,reduceAnimations:n.bool,referenceDate:n.object,renderLoading:n.func,shouldDisableDate:n.func,shouldDisableMonth:n.func,shouldDisableYear:n.func,showDaysOutsideCurrentMonth:n.bool,slotProps:n.object,slots:n.object,sx:n.oneOfType([n.arrayOf(n.oneOfType([n.func,n.object,n.bool])),n.func,n.object]),timezone:n.string,value:n.object,view:n.oneOf(["day","month","year"]),views:n.arrayOf(n.oneOf(["day","month","year"]).isRequired),yearsPerRow:n.oneOf([3,4])});export{A as DateCalendar};
