import e from"../../../../../@babel/runtime/helpers/esm/extends.js";import o from"../../../../../@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js";import*as i from"react";import{useViews as s}from"../useViews.js";import{isTimeView as t}from"../../utils/time-utils.js";import n from"../../../../utils/useEventCallback/useEventCallback.js";import r from"../../../../utils/useEnhancedEffect/useEnhancedEffect.js";const u=["className","sx"],l=({props:l,propsFromPickerValue:w,additionalViewProps:a,autoFocusView:c,rendererInterceptor:d,fieldRef:m})=>{const{onChange:p,open:f,onClose:V}=w,{views:h,openTo:v,onViewChange:C,viewRenderers:I,timezone:U}=l,g=o(l,u),{view:b,setView:j,defaultView:F,focusedView:k,setFocusedView:E,setValueAndGoToNextView:M}=s({view:void 0,views:h,openTo:v,onChange:p,onViewChange:C,autoFocus:c}),{hasUIView:x,viewModeLookup:L}=i.useMemo((()=>h.reduce(((e,o)=>{let i;return i=null!=I[o]?"UI":"field",e.viewModeLookup[o]=i,"UI"===i&&(e.hasUIView=!0),e}),{hasUIView:!1,viewModeLookup:{}})),[I,h]),P=i.useMemo((()=>h.reduce(((e,o)=>null!=I[o]&&t(o)?e+1:e),0)),[I,h]),S=L[b],T=n((()=>"UI"===S)),[R,z]=i.useState("UI"===S?b:null);R!==b&&"UI"===L[b]&&z(b),r((()=>{"field"===S&&f&&(V(),setTimeout((()=>{m?.current?.setSelectedSections(b),m?.current?.focusField(b)})))}),[b]),r((()=>{if(!f)return;let e=b;"field"===S&&null!=R&&(e=R),e!==F&&"UI"===L[e]&&"UI"===L[F]&&(e=F),e!==b&&j(e),E(e,!0)}),[f]);return{hasUIView:x,shouldRestoreFocus:T,layoutProps:{views:h,view:R,onViewChange:j},renderCurrentView:()=>{if(null==R)return null;const o=I[R];if(null==o)return null;const i=e({},g,a,w,{views:h,timezone:U,onChange:M,view:R,onViewChange:j,focusedView:k,onFocusedViewChange:E,showViewSwitcher:P>1,timeViewsCount:P});return d?d(I,R,i):o(i)}}};export{l as usePickerViews};
