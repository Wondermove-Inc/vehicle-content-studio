import e from"../../../../../@babel/runtime/helpers/esm/extends.js";import*as t from"react";import{publishTreeViewEvent as r}from"../../utils/publishTreeViewEvent.js";import{useTreeViewContext as i}from"../../TreeViewProvider/useTreeViewContext.js";import{TreeViewChildrenItemProvider as n,TreeViewChildrenItemContext as s}from"../../TreeViewProvider/TreeViewChildrenItemProvider.js";import{buildSiblingIndexes as o,TREE_VIEW_ROOT_PARENT_ID as m}from"../useTreeViewItems/useTreeViewItems.utils.js";import{jsx as d}from"react/jsx-runtime";import a from"../../../../utils/useEventCallback/useEventCallback.js";import{TreeViewItemDepthContext as l}from"../../TreeViewItemDepthContext/TreeViewItemDepthContext.js";import p from"../../../../utils/useForkRef/useForkRef.js";import u from"../../../../utils/useEnhancedEffect/useEnhancedEffect.js";const c=({instance:t,setState:i})=>{t.preventItemUpdates();return{instance:{insertJSXItem:a((n=>(i((t=>{if(null!=t.items.itemMetaMap[n.id])throw new Error(["MUI X: The Tree View component requires all items to have a unique `id` property.","Alternatively, you can use the `getItemId` prop to specify a custom id for each item.",`Two items were provided with the same id in the \`items\` prop: "${n.id}"`].join("\n"));return e({},t,{items:e({},t.items,{itemMetaMap:e({},t.items.itemMetaMap,{[n.id]:n}),itemMap:e({},t.items.itemMap,{[n.id]:{id:n.id,label:n.label}})})})})),()=>{i((t=>{const r=e({},t.items.itemMetaMap),i=e({},t.items.itemMap);return delete r[n.id],delete i[n.id],e({},t,{items:e({},t.items,{itemMetaMap:r,itemMap:i})})})),r(t,"removeItem",{id:n.id})}))),setJSXItemsOrderedChildrenIds:(t,r)=>{const n=t??m;i((t=>e({},t,{items:e({},t.items,{itemOrderedChildrenIds:e({},t.items.itemOrderedChildrenIds,{[n]:r}),itemChildrenIndexes:e({},t.items.itemChildrenIndexes,{[n]:o(r)})})})))},mapFirstCharFromJSX:a(((r,i)=>(t.updateFirstCharMap((e=>(e[r]=i,e))),()=>{t.updateFirstCharMap((t=>{const i=e({},t);return delete i[r],i}))})))}}},h=e=>Array.isArray(e)?e.length>0&&e.some(h):Boolean(e);c.itemPlugin=({props:e,rootRef:r,contentRef:n})=>{const{instance:o}=i(),{children:m,disabled:d=!1,label:a,itemId:l,id:c}=e,f=t.useContext(s);if(null==f)throw new Error(["MUI X: Could not find the Tree View Children Item context.","It looks like you rendered your component outside of a SimpleTreeView parent component.","This can also happen if you are bundling multiple versions of the Tree View."].join("\n"));const{registerChild:I,unregisterChild:w,parentId:C}=f,M=h(m),T=t.useRef(null),v=p(T,n);return u((()=>{const e=o.getTreeItemIdAttribute(l,c);return I(e,l),()=>{w(e)}}),[o,I,w,l,c]),t.useEffect((()=>o.insertJSXItem({id:l,idAttribute:c,parentId:C,expandable:M,disabled:d})),[o,C,l,M,d,c]),t.useEffect((()=>{if(a)return o.mapFirstCharFromJSX(l,(T.current?.textContent??"").substring(0,1).toLowerCase())}),[o,l,a]),{contentRef:v,rootRef:r}},c.wrapItem=({children:e,itemId:r})=>{const i=t.useContext(l);return d(n,{itemId:r,children:d(l.Provider,{value:i+1,children:e})})},c.wrapRoot=({children:e})=>d(n,{children:d(l.Provider,{value:0,children:e})}),c.params={};export{c as useTreeViewJSXItems};
