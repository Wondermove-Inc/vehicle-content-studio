import e from"../../../../@babel/runtime/helpers/esm/extends.js";import*as t from"react";import{useTreeViewModels as r}from"./useTreeViewModels.js";import{extractPluginParamsFromProps as o}from"./extractPluginParamsFromProps.js";import{TREE_VIEW_CORE_PLUGINS as n}from"../corePlugins/corePlugins.js";import s from"../../../utils/useForkRef/useForkRef.js";function i(e){const r=t.useRef({});return e?(null==e.current&&(e.current={}),e.current):r.current}const a=({plugins:a,rootRef:c,props:l})=>{const u=[...n,...a],{pluginParams:p,forwardedProps:f,apiRef:m,experimentalFeatures:R,slots:g,slotProps:P}=o({plugins:u,props:l}),h=r(u,p),d=t.useRef({}).current,b=i(m),j=t.useRef(null),I=s(j,c),[x,w]=t.useState((()=>{const e={};return u.forEach((t=>{t.getInitialState&&Object.assign(e,t.getInitialState(p))})),e})),E=u.map((e=>e.wrapItem)).filter((e=>!!e)),F=u.map((e=>e.wrapRoot)).filter((e=>!!e)).reverse(),O={publicAPI:b,wrapItem:({itemId:e,children:t})=>{let r=t;return E.forEach((t=>{r=t({itemId:e,children:r,instance:d})})),r},wrapRoot:({children:e})=>{let t=e;return F.forEach((e=>{t=e({children:t,instance:d})})),t},runItemPlugins:e=>{let t=null,r=null;return u.forEach((o=>{if(!o.itemPlugin)return;const n=o.itemPlugin({props:e,rootRef:t,contentRef:r});n?.rootRef&&(t=n.rootRef),n?.contentRef&&(r=n.contentRef)})),{contentRef:r,rootRef:t}},instance:d,rootRef:j},S=[];u.forEach((e=>{const t=e({instance:d,params:p,slots:g,slotProps:P,experimentalFeatures:R,state:x,setState:w,rootRef:j,models:h});t.getRootProps&&S.push(t.getRootProps),t.publicAPI&&Object.assign(b,t.publicAPI),t.instance&&Object.assign(d,t.instance),t.contextValue&&Object.assign(O,t.contextValue)}));return{getRootProps:(t={})=>{const r=e({role:"tree"},f,t,{ref:I});return S.forEach((e=>{Object.assign(r,e(t))})),r},rootRef:I,contextValue:O,instance:d}};export{a as useTreeView,i as useTreeViewApiInitialization};
